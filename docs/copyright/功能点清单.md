# AI Fashion Studio 功能点清单

## 软件名称

**AI Fashion Studio - 基于人工智能的时尚图像生成与管理平台**

## 版本

V1.0

## 功能点列表

### 功能点1：用户注册与登录功能

**功能描述**:
系统提供完整的用户账号管理功能，支持用户通过邮箱进行注册和登录。注册时需要进行邮箱验证，确保用户身份的真实性。登录采用JWT（JSON Web Token）认证机制，实现安全的身份验证和授权管理。用户可以修改个人资料、密码等基本信息。

**功能特点**:
- 邮箱注册和验证
- 用户名和密码登录
- JWT Token认证
- 个人资料管理
- 密码修改功能
- 登录状态保持

**技术实现**:
- 前端：React表单组件 + Zod验证
- 后端：NestJS Auth模块 + JWT Guard
- 数据库：User模型存储用户信息
- 安全：密码bcrypt加密存储

---

### 功能点2：服装图像上传与管理功能

**功能描述**:
用户可以上传服装平铺图作为生成图片的参考素材。系统支持批量上传多个服装图片，每个任务最多支持20张图片。上传时支持拖拽上传和点击选择两种方式。系统自动对上传的图片进行格式验证、大小限制检查，并进行压缩处理以优化存储和传输效率。用户可以查看、删除已上传的图片。

**功能特点**:
- 批量图片上传（最多20张）
- 拖拽上传和点击选择
- 图片格式验证（JPG、PNG）
- 图片大小限制（单张10MB）
- 自动图片压缩
- 图片预览功能
- 删除已上传图片

**技术实现**:
- 前端：React Dropzone + 图片压缩库
- 后端：NestJS Multer中间件处理文件上传
- 存储：腾讯云COS对象存储
- 压缩：前端Image Compressor库

---

### 功能点3：AI需求分析功能

**功能描述**:
系统采用AI技术（Gemini 2.0 Flash）对用户上传的服装图片和填写的需求进行智能分析。AI自动分析每张参考图的视角、焦点、描述等关键信息，提取服装的特征元素（如颜色、材质、设计细节等）。系统能够理解用户的自然语言需求描述，识别图片使用的平台（如小红书、淘宝、Instagram）、风格类型（如潮牌、高街、休闲）、场景要求等关键参数，为后续的图像生成提供准确的输入。

**功能特点**:
- AI智能分析参考图片
- 自动提取服装特征
- 理解自然语言需求
- 识别平台和风格类型
- 提取场景和约束条件
- 生成结构化分析结果

**技术实现**:
- AI模型：Gemini 2.0 Flash
- 提示词：结构化Brain系统提示词（43KB）
- 后端：NestJS Brain Service
- 缓存：Redis缓存分析结果（7天TTL）

---

### 功能点4：智能拍摄计划生成功能

**功能描述**:
基于AI需求分析的结果，系统自动生成详细的拍摄计划（Shot List）。Shot List包含每张图片的拍摄指令，包括场景描述、人物动作、镜头角度、光线要求等详细参数。系统还会生成GARMENT LOCK（服装特征锁定），提取服装的关键特征（如领型、袖长、图案位置等）并锁定，确保同一任务中所有生成图片的服装细节保持一致。用户可以查看、编辑生成的计划，包括修改GARMENT LOCK、调整Shot List、编辑Prompt等。

**功能特点**:
- 自动生成Shot List
- GARMENT LOCK机制
- 每张图独立的拍摄指令
- 生成英文Prompt
- 计划可编辑和确认
- 服装特征锁定保证一致性

**技术实现**:
- AI模型：Gemini 2.0 Flash
- 后端：NestJS Brain Service
- 前端：React组件展示和编辑
- 数据存储：Task模型存储计划数据

---

### 功能点5：图像AI生成功能

**功能描述**:
系统采用先进的AI图像生成技术（Gemini 3 Pro），根据Shot List和Prompt自动生成高质量的时尚模特展示图。支持两种生成模式：逐张生成和批量生成。逐张生成模式下，系统按Shot List逐张生成图片，每张图生成后可立即进行质检；批量生成模式下，系统并行生成多张图片，提高效率。用户可以配置生成参数，包括分辨率（512x512、768x768、1024x1024等）、比例（1:1、3:4、4:3、16:9等）、模型选择等。系统支持生成进度实时显示，显示当前正在生成的图片和已完成的图片数量。

**功能特点**:
- AI自动生成图片
- 逐张生成和批量生成模式
- 多种分辨率和比例选择
- 生成进度实时显示
- 生成失败自动重试
- 多模型支持

**技术实现**:
- AI模型：Gemini 3 Pro (Image Preview)
- 后端：NestJS Painter Service + SCF云函数
- 并发控制：Bottleneck限流（最大并发5）
- 进度跟踪：WebSocket实时推送

---

### 功能点6：图像质量质检功能

**功能描述**:
每张图片生成完成后，系统进入质量检查环节。用户可以大图预览生成的图片，与参考图进行对比，查看使用的Prompt等详细信息。系统提供三种质检选项：通过（图片质量满意）、需要修复（图片有瑕疵，进入修复流程）、重新生成（不满意，重新生成该张）。用户可以批量标记多张图片，批量执行质检操作，提高效率。质检结果会被记录，方便后续追溯和统计。

**功能特点**:
- 大图预览图片
- 与参考图对比
- 查看生成Prompt
- 三种质检选项
- 批量质检操作
- 质检结果记录

**技术实现**:
- 前端：React图片灯箱组件
- 后端：NestJS Task Service
- 对比功能：Canvas并排对比
- 数据存储：Shot模型存储质检结果

---

### 功能点7：图像智能修复功能

**功能描述**:
针对质检不通过的图片，系统提供智能修复功能。AI自动分析生成图与参考图的差异，生成差异清单（哪些地方不一致）。然后AI生成修复方案和修复指令草稿，用户可以编辑和确认修复指令。执行修复时，系统仅修复衣服细节，保持模特、场景、光线、镜头等要素不变。修复完成后，用户可以对修复结果进行质检，满意则通过，不满意可以继续修复或重新生成。修复过程中，系统完整记录修复历史，包括差异分析、修复方案、修复指令、修复前后图片等。

**功能特点**:
- AI自动分析差异
- 生成修复方案和指令
- 修复指令可编辑
- 精准修复（只改衣服细节）
- 保持模特、场景、光线不变
- 修复历史记录

**技术实现**:
- AI模型：Gemini 2.0 Flash（分析） + Gemini 3 Pro（修复）
- 后端：NestJS Fix Service
- 前端：React修复编辑器
- 数据存储：Fix模型存储修复历史

---

### 功能点8：风格预设管理功能

**功能描述**:
系统提供风格预设管理功能，允许用户从参考图中学习风格，并创建可复用的风格预设。用户上传参考图片后，AI自动分析图片的风格特征，提取色调、光线、质感、构图等风格参数。用户可以编辑提取的风格参数，输入预设名称和描述，保存为风格预设。风格预设可以在创建任务时快速应用，将预设的风格参数自动应用到新生成的图片，提高效率并保证风格一致性。用户可以管理自己的风格预设，包括编辑、删除、复制等操作。

**功能特点**:
- AI自动分析风格特征
- 提取色调、光线、质感等参数
- 风格参数可编辑
- 保存为可复用预设
- 快速应用到新任务
- 风格预设管理

**技术实现**:
- AI模型：Gemini 2.0 Flash
- 后端：NestJS StylePreset Service
- 前端：React风格预设选择器
- 数据存储：StylePreset模型
- 状态管理：Zustand Store

---

### 功能点9：人脸预设管理功能

**功能描述**:
系统提供人脸预设管理功能，允许用户从参考图中提取人脸特征，并创建可复用的人脸预设。用户上传包含人脸的参考图片后，AI自动分析人脸特征，提取面部轮廓、五官特征、表情等参数。用户可以编辑提取的人脸参数，输入预设名称和描述，保存为人脸预设。人脸预设可以在创建任务时快速应用，将预设的人脸特征自动应用到新生成的图片，使生成的模特面部保持一致。用户可以管理自己的人脸预设，包括编辑、删除、复制等操作。

**功能特点**:
- AI自动分析人脸特征
- 提取面部轮廓和五官特征
- 人脸参数可编辑
- 保存为可复用预设
- 快速应用到新任务
- 人脸预设管理

**技术实现**:
- AI模型：Gemini 2.0 Flash
- 后端：NestJS FacePreset Service
- 前端：React人脸预设选择器
- 数据存储：FacePreset模型
- 状态管理：Zustand Store

---

### 功能点10：姿势预设管理功能

**功能描述**:
系统提供姿势预设管理功能，允许用户从参考图中学习人物姿势，并创建可复用的姿势预设。用户上传参考图片后，AI自动分析人物姿势，提取身体姿态、动作类型、角度等参数。用户可以编辑提取的姿势参数，输入预设名称和描述，保存为姿势预设。姿势预设可以在创建任务时快速应用，将预设的姿势参数自动应用到新生成的图片，使生成的模特姿势保持一致。用户可以管理自己的姿势预设，包括编辑、删除、复制等操作。

**功能特点**:
- AI自动分析人物姿势
- 提取身体姿态和动作参数
- 姿势参数可编辑
- 保存为可复用预设
- 快速应用到新任务
- 姿势预设管理

**技术实现**:
- AI模型：Gemini 2.0 Flash
- 后端：NestJS PosePreset Service
- 前端：React姿势预设选择器
- 数据存储：PosePreset模型
- 状态管理：Zustand Store

---

### 功能点11：批量任务处理功能

**功能描述**:
系统提供企业级批量任务处理功能，支持高效管理多个任务。用户可以创建批量任务，选择任务类型（传统模式或直出模式），上传多个服装图片，填写统一需求参数。系统将任务添加到批量队列，支持设置任务优先级（高、中、低），高优先级任务优先处理。批量工作室提供任务队列管理功能，显示每个任务的状态（等待中、生成中、质检中、已完成、失败），用户可以操作任务（开始、暂停、取消、删除）。系统支持批量导出功能，可以一次性导出多个任务的图片，自动打包为ZIP文件下载。

**功能特点**:
- 创建批量任务
- 任务队列管理
- 任务优先级设置
- 任务状态跟踪
- 任务操作（开始、暂停、取消、删除）
- 批量导出功能

**技术实现**:
- 后端：NestJS Task Service + Queue Service
- 并发控制：Bottleneck限流
- 任务编排：TaskRenderingOrchestrator
- 状态管理：Zustand Store
- 前端：React批量工作室组件

---

### 功能点12：任务队列管理功能

**功能描述**:
系统提供完善的任务队列管理功能，支持对大量任务进行统一管理和调度。队列系统支持任务排队、并发控制、错误重试、优先级调度等功能。用户可以查看队列中所有任务的状态，实时了解任务进度。系统自动处理任务的生命周期，包括创建、排队、执行、完成、失败等状态转换。任务执行失败时，系统会自动重试，提高任务成功率。用户可以手动干预队列，如暂停队列、清空队列、调整优先级等。

**功能特点**:
- 任务排队和调度
- 并发控制
- 错误自动重试
- 优先级调度
- 实时状态跟踪
- 手动干预功能

**技术实现**:
- 后端：NestJS Queue Service
- 并发控制：Bottleneck（最大并发5，最小间隔200ms）
- 错误处理：自动重试机制（最多3次）
- 进度推送：WebSocket实时更新
- 数据存储：Task和Queue模型

---

### 功能点13：图像导出功能

**功能描述**:
系统提供灵活的图像导出功能，支持单张导出和批量导出。单张导出时，用户可以选择导出格式（JPG或PNG）、图片尺寸等参数，系统将图片下载到本地。批量导出时，用户可以勾选需要导出的图片，选择统一的导出格式、是否添加水印、文件命名规则等，系统自动将选中的图片打包为ZIP文件并下载。导出的图片保持高质量，适合后续编辑和使用。

**功能特点**:
- 单张图片导出
- 批量图片导出
- 支持JPG和PNG格式
- 可选添加水印
- 自定义文件命名
- ZIP打包下载

**技术实现**:
- 后端：NestJS Export Service
- 前端：React导出组件
- 打包：JSZip库
- 下载：Blob下载
- 水印：Canvas水印处理

---

### 功能点14：积分计费功能

**功能描述**:
系统提供完整的积分计费功能，实现对服务使用的精确计费。用户在创建任务时，系统根据任务的张数、使用的模型、是否修复等参数计算所需积分，并在任务开始前预扣积分。任务完成后，系统根据实际消耗进行结算，多退少补。系统支持积分充值功能，用户可以在个人中心充值积分，选择充值金额和支付方式完成充值。系统记录所有积分的变动，包括充值、消费、退款、奖励等，用户可以查看详细的积分账单。管理员可以配置积分规则，如任务消耗积分、修复消耗积分、邀请奖励积分等。

**功能特点**:
- 积分预扣和结算
- 积分充值功能
- 积分账单记录
- 积分规则配置
- 积分统计和分析
- 邀请奖励积分

**技术实现**:
- 后端：NestJS Credit Service
- 计费：TaskBilling Service
- 数据存储：Credit模型 + CreditTransaction模型
- 前端：React积分管理组件
- 支付集成：第三方支付API

---

### 功能点15：管理后台功能

**功能描述**:
系统提供功能完善的管理后台，供管理员进行系统管理和运营。管理后台包含用户管理、任务管理、数据分析、提示词管理、模型配置、积分系统、日志管理等多个模块。用户管理模块支持查看所有用户，进行创建、编辑、删除、禁用/启用等操作。任务管理模块支持查看所有任务，进行筛选、搜索、查看详情、删除等操作。数据分析模块提供数据看板和图表，展示用户统计、任务统计、积分统计等关键指标。提示词管理模块支持编辑Brain提示词、学习提示词、工作流提示词、直出提示词等各类提示词模板。模型配置模块支持配置AI模型参数。日志管理模块记录所有用户的操作日志，支持筛选和导出。

**功能特点**:
- 用户管理
- 任务管理
- 数据分析和统计
- 提示词管理
- 模型配置
- 积分系统管理
- 邀请码管理
- 日志管理

**技术实现**:
- 后端：NestJS Admin模块
- 前端：Next.js Admin页面
- 认证：管理员权限Guard
- 数据存储：各个管理模块对应的数据模型
- 图表：Recharts或ECharts

---

## 功能点统计

| 功能点 | 模块 | 主要技术 |
|-------|------|---------|
| 1 | 用户系统 | JWT认证、bcrypt加密 |
| 2 | 图像管理 | 腾讯云COS、图片压缩 |
| 3 | AI需求分析 | Gemini 2.0 Flash、Brain Service |
| 4 | 计划生成 | GARMENT LOCK、Shot List |
| 5 | 图像生成 | Gemini 3 Pro、SCF云函数 |
| 6 | 图像质检 | 灯箱预览、批量质检 |
| 7 | 图像修复 | 智能修复、精准改图 |
| 8 | 风格预设 | AI风格分析、预设管理 |
| 9 | 人脸预设 | AI人脸分析、预设管理 |
| 10 | 姿势预设 | AI姿势分析、预设管理 |
| 11 | 批量处理 | 任务队列、优先级调度 |
| 12 | 队列管理 | 并发控制、错误重试 |
| 13 | 图像导出 | 打包下载、水印处理 |
| 14 | 积分计费 | 预扣结算、账单记录 |
| 15 | 管理后台 | 系统管理、数据分析 |

## 创新点总结

1. **双模AI协作架构**: Brain（策划者）和Painter（执行者）分离，专业化处理不同环节
2. **GARMENT LOCK机制**: 锁定服装关键特征，确保多图一致性
3. **智能修复闭环**: 仅修复衣服细节，保持模特、场景、光线等不变
4. **知识沉淀系统**: 支持从参考图学习风格和姿势，创建可复用预设
5. **企业级批量处理**: 支持任务队列、优先级调度、并发控制
6. **三层预设系统**: 风格、人脸、姿势三层预设，快速组合应用
7. **完整的追溯性**: 记录输入图、Prompt、参数、输出图、修复版本

---

**文档版本**: V1.0
**最后更新**: 2026-01-27
